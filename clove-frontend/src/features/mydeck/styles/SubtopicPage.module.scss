
@use "/variables" as *;

.myDeckWrapper {
  flex-grow: 1;
  padding: 2.5rem;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background-color: var(--bg);
  color: var(--text);
  font-family: "Space Grotesk", sans-serif;
  background-image: radial-gradient(circle at 20% 30%, rgba(108, 92, 231, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 70%, rgba(255, 118, 117, 0.1) 0%, transparent 50%);
  overflow-x: hidden;
  overflow-y: hidden;
  position: relative;
  
  // Hide scrollbars while maintaining scroll functionality
  &::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
  
  @media (max-width: 768px) { padding: 1.5rem;   }
}

.loadingOverlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.loadingContent {
  background-color: #181926;
  padding: 20px 40px;
  border-radius: 8px;
  color: #cbd5e1;
  font-size: 16px;
  text-align: center;
}

.loadingSpinner {
  width: 24px;
  height: 24px;
  border: 3px solid #23233a;
  border-top: 3px solid #a6aafb;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.myDeckWrapper.wizardTheme,
.myDeckWrapper.wizardThemeBg { background-color: transparent !important; background-image: none !important; }
.wizardTheme { background-color: transparent !important; }
.myDeckWrapper.spaceTheme { background-color: var(--theme-bg, #0a0a1a) !important; background-image: none !important; }
.myDeckWrapper.spaceTheme { background-color: #0a0a1a !important; background-image: none !important; }
.myDeckWrapper.spaceTheme { background: #0a0a1a !important; }
.myDeckWrapper.detectiveTheme { background-color: transparent !important; background-image: none !important; }

.lessonWrapper { position: relative; }

.briefContainer { background: rgba(255,255,255,0.1); backdrop-filter: blur(3px); border-radius: 40px; border: 1px solid var(--primary); }
.briefText { white-space: pre-wrap; text-align: justify; }

.subtopicRow { display: flex; justify-content: center; align-items: center; gap: 5rem; margin-bottom: 12rem; padding-bottom: 8rem; }
@media (max-width: 600px) { .subtopicRow { gap: 2rem; } }

.subtopicIconWrapper { display: flex; align-items: center; justify-content: center; width: 180px; height: 180px; margin: 0 auto 1.5rem auto; background: #222 !important; border-radius: 50%; box-shadow: 0 4px 24px rgba(0,0,0,0.10); transition: box-shadow 0.2s, cursor 0.2s; }
.subtopicIconWrapper::before, .subtopicIconWrapper::after { background: #222 !important; opacity: 1 !important; border-radius: 50%; box-shadow: none !important; border: none !important; content: none !important; }
.subtopicIconWrapper img { width: 160px !important; height: 160px !important; object-fit: contain; }
.lockedImage { filter: grayscale(1); cursor: not-allowed; opacity: 0.5; }

// Unlocked subtopics - glowing border and pointer cursor
.subtopicIconWrapper:not(.lockedImage) {
  cursor: pointer;
  
  &:hover {
    cursor: pointer;
  }
}
.text-center.text-white h5 { font-size: 2rem; margin-bottom: 0.75rem; }
.popover-body { font-size: 1.25rem; }
.lockedHint { color: var(--wrong); margin-top: 0.5rem; font-size: 1.05rem; }
.popover { background: var(--card-bg); border: 1px solid var(--primary); color: var(--text); .popover-body { padding: 1rem; } }

@keyframes twinkle { 0% { opacity: 0.3; } 100% { opacity: 1; } }
@keyframes floatRock { 0% { transform: translateY(0); } 100% { transform: translateY(-12px); } }
// Pulsing glow animation for unlocked subtopics
// Animates the opacity of drop-shadow filters to create a breathing effect
@keyframes pulseGlowWizard {
  0%, 100% { 
    filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.4)) 
            drop-shadow(0 0 16px rgba(245, 158, 11, 0.3)) 
            drop-shadow(0 0 24px rgba(251, 191, 36, 0.2));
  }
  50% { 
    filter: drop-shadow(0 0 12px rgba(251, 191, 36, 0.8)) 
            drop-shadow(0 0 24px rgba(245, 158, 11, 0.6)) 
            drop-shadow(0 0 36px rgba(251, 191, 36, 0.5));
  }
}

@keyframes pulseGlowDetective {
  0%, 100% { 
    filter: drop-shadow(0 0 8px rgba(244, 224, 77, 0.5)) 
            drop-shadow(0 0 16px rgba(255, 200, 87, 0.4)) 
            drop-shadow(0 0 24px rgba(255, 193, 7, 0.3));
  }
  50% { 
    filter: drop-shadow(0 0 12px rgba(244, 224, 77, 0.9)) 
            drop-shadow(0 0 24px rgba(255, 200, 87, 0.7)) 
            drop-shadow(0 0 36px rgba(255, 193, 7, 0.6));
  }
}

@keyframes pulseGlowSpace {
  0%, 100% { 
    filter: drop-shadow(0 0 8px rgba(166, 170, 251, 0.4)) 
            drop-shadow(0 0 16px rgba(139, 92, 246, 0.3)) 
            drop-shadow(0 0 24px rgba(166, 170, 251, 0.2));
  }
  50% { 
    filter: drop-shadow(0 0 12px rgba(166, 170, 251, 0.8)) 
            drop-shadow(0 0 24px rgba(139, 92, 246, 0.6)) 
            drop-shadow(0 0 36px rgba(166, 170, 251, 0.5));
  }
}

.storyContainer { background: rgba(24,32,72,0.85); border-radius: 18px; border: 1.5px solid rgba(120,140,255,0.18); box-shadow: 0 2px 24px 0 rgba(80,120,255,0.18); padding: 1.5rem 2rem; margin: 0 0 2rem 0; max-width: 900px; width: 100%; display: flex; align-items: center; justify-content: center; text-align: center; color: #e6e6fa; font-family: 'Space Grotesk', 'Roboto', sans-serif; font-size: 1.08rem; font-weight: 400; line-height: 1.7; letter-spacing: 0.01em; transition: box-shadow 0.3s, background 0.3s; position: relative; z-index: 1001; }
.storyText { margin: 0; padding: 0; color: #e6e6fa; font-size: 1.08rem; font-family: inherit; font-weight: inherit; line-height: 1.7; text-align: center; }
.briefText, .briefContainer { border: none !important; background: none !important; }
.wizardTheme { background-color: var(--theme-bg); }
.spaceTheme { background-color: var(--theme-bg); }
.detectiveTheme { background-color: var(--theme-bg); }
.spaceTheme .subtopicIconWrapper { background: transparent !important; }
.spaceTheme .subtopicIconWrapper.lockedImage { box-shadow: none !important; }
.detectiveTheme .subtopicIconWrapper { background: transparent !important; }
.detectiveTheme .subtopicIconWrapper.lockedImage { box-shadow: none !important; }
.detectiveTheme .subtopicIconWrapper img { width: 200px !important; height: 200px !important; object-fit: contain; }

// Glowing effect for unlocked subtopics - follows icon shape using drop-shadow
// drop-shadow follows the image's alpha channel, so it glows around the actual icon shape
// Using .myDeckWrapper parent class for proper CSS module scoping and higher specificity

// Static glow for all unlocked subtopics (non-newly unlocked)
.myDeckWrapper.wizardTheme .subtopicIconWrapper:not(.lockedImage):not(.newlyUnlocked) img {
  filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.4)) 
          drop-shadow(0 0 16px rgba(245, 158, 11, 0.3)) 
          drop-shadow(0 0 24px rgba(251, 191, 36, 0.2));
  transition: filter 0.3s ease;
}

.myDeckWrapper.wizardTheme .subtopicIconWrapper:not(.lockedImage):not(.newlyUnlocked):hover img {
  filter: drop-shadow(0 0 12px rgba(251, 191, 36, 0.8)) 
          drop-shadow(0 0 24px rgba(245, 158, 11, 0.6)) 
          drop-shadow(0 0 36px rgba(251, 191, 36, 0.5));
}

// Pulsing glow only for newly unlocked subtopic
.myDeckWrapper.wizardTheme .subtopicIconWrapper:not(.lockedImage).newlyUnlocked img {
  animation: pulseGlowWizard 2s ease-in-out infinite;
  transition: filter 0.3s ease;
}

.myDeckWrapper.wizardTheme .subtopicIconWrapper:not(.lockedImage).newlyUnlocked:hover img {
  filter: drop-shadow(0 0 12px rgba(251, 191, 36, 0.8)) 
          drop-shadow(0 0 24px rgba(245, 158, 11, 0.6)) 
          drop-shadow(0 0 36px rgba(251, 191, 36, 0.5));
  animation: none; // Stop pulsing on hover for smoother interaction
}

// Static glow for all unlocked subtopics (non-newly unlocked) - Detective theme
.myDeckWrapper.detectiveTheme .subtopicIconWrapper:not(.lockedImage):not(.newlyUnlocked) img {
  filter: drop-shadow(0 0 8px rgba(244, 224, 77, 0.5)) 
          drop-shadow(0 0 16px rgba(255, 200, 87, 0.4)) 
          drop-shadow(0 0 24px rgba(255, 193, 7, 0.3));
  transition: filter 0.3s ease;
}

.myDeckWrapper.detectiveTheme .subtopicIconWrapper:not(.lockedImage):not(.newlyUnlocked):hover img {
  filter: drop-shadow(0 0 12px rgba(244, 224, 77, 0.9)) 
          drop-shadow(0 0 24px rgba(255, 200, 87, 0.7)) 
          drop-shadow(0 0 36px rgba(255, 193, 7, 0.6));
}

// Pulsing glow only for newly unlocked subtopic - Detective theme
.myDeckWrapper.detectiveTheme .subtopicIconWrapper:not(.lockedImage).newlyUnlocked img {
  animation: pulseGlowDetective 2s ease-in-out infinite;
  transition: filter 0.3s ease;
}

.myDeckWrapper.detectiveTheme .subtopicIconWrapper:not(.lockedImage).newlyUnlocked:hover img {
  filter: drop-shadow(0 0 12px rgba(244, 224, 77, 0.9)) 
          drop-shadow(0 0 24px rgba(255, 200, 87, 0.7)) 
          drop-shadow(0 0 36px rgba(255, 193, 7, 0.6));
  animation: none; // Stop pulsing on hover for smoother interaction
}

// Static glow for all unlocked subtopics (non-newly unlocked) - Space theme
.myDeckWrapper.spaceTheme .subtopicIconWrapper:not(.lockedImage):not(.newlyUnlocked) img {
  filter: drop-shadow(0 0 8px rgba(166, 170, 251, 0.4)) 
          drop-shadow(0 0 16px rgba(139, 92, 246, 0.3)) 
          drop-shadow(0 0 24px rgba(166, 170, 251, 0.2));
  transition: filter 0.3s ease;
}

.myDeckWrapper.spaceTheme .subtopicIconWrapper:not(.lockedImage):not(.newlyUnlocked):hover img {
  filter: drop-shadow(0 0 12px rgba(166, 170, 251, 0.8)) 
          drop-shadow(0 0 24px rgba(139, 92, 246, 0.6)) 
          drop-shadow(0 0 36px rgba(166, 170, 251, 0.5));
}

// Pulsing glow only for newly unlocked subtopic - Space theme
.myDeckWrapper.spaceTheme .subtopicIconWrapper:not(.lockedImage).newlyUnlocked img {
  animation: pulseGlowSpace 2s ease-in-out infinite;
  transition: filter 0.3s ease;
}

.myDeckWrapper.spaceTheme .subtopicIconWrapper:not(.lockedImage).newlyUnlocked:hover img {
  filter: drop-shadow(0 0 12px rgba(166, 170, 251, 0.8)) 
          drop-shadow(0 0 24px rgba(139, 92, 246, 0.6)) 
          drop-shadow(0 0 36px rgba(166, 170, 251, 0.5));
  animation: none; // Stop pulsing on hover for smoother interaction
}
.detectiveTheme .storyContainer { animation: detectiveFlicker 2.2s infinite steps(1, end); background: rgba(30,32,38,0.92); box-shadow: 0 0 32px 8px rgba(255,255,200,0.10), 0 0 0 0 transparent; color: #e0dfdb; }
.detectiveTheme .storyContainer h1, .detectiveTheme .storyContainer h2 { color: #f4e04d; }
@keyframes detectiveFlicker { 0%,100% { background: rgba(30,32,38,0.92); box-shadow: 0 0 32px 8px rgba(255,255,200,0.10), 0 0 0 0 transparent; } 5% { background: rgba(50,54,70,0.98); box-shadow: 0 0 48px 16px rgba(255,255,200,0.18), 0 0 0 0 transparent; } 10% { background: rgba(30,32,38,0.92); box-shadow: 0 0 32px 8px rgba(255,255,200,0.10), 0 0 0 0 transparent; } 15% { background: rgba(50,54,70,0.98); box-shadow: 0 0 48px 16px rgba(255,255,200,0.18), 0 0 0 0 transparent; } 20% { background: rgba(30,32,38,0.92); box-shadow: 0 0 32px 8px rgba(255,255,200,0.10), 0 0 0 0 transparent; } }
.gridLayout { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: repeat(var(--node-count, 4), minmax(120px, auto)); column-gap: 25rem; row-gap: 20rem; justify-content: center; align-items: center; width: 100%; max-width: 800px; margin: 0 auto; position: relative; z-index: 1; margin-bottom: 12rem; padding-bottom: 8rem; }
.detectiveTheme .lockedImage img { filter: grayscale(1); opacity: 1; }
.wizardTheme .subtopicIconWrapper { background: transparent !important; }
.wizardTheme .subtopicIconWrapper.lockedImage { box-shadow: none !important; }
.wizardTheme .storyContainer { 
  background: rgba(15, 23, 42, 0.92); 
  color: #E8DBC3; 
  box-shadow: 0 0 32px 8px rgba(14, 165, 233, 0.2), 0 0 64px 16px rgba(6, 182, 212, 0.15); 
  border: 1.5px solid rgba(14, 165, 233, 0.3);
  font-family: "Crimson Text", serif;
}
.wizardTheme .storyContainer h1, .wizardTheme .storyContainer h2 { 
  color: #FBBF24; 
  text-shadow: 0 0 8px rgba(251, 191, 36, 0.5), 0 0 16px rgba(14, 165, 233, 0.3); 
  font-family: 'Cinzel', serif; 
  letter-spacing: 0.04em; 
}
.backgroundImage { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -2; pointer-events: none; user-select: none; }
.blur { filter: blur(4px); }

.introductionButtonContainer {
  margin-bottom: 20px;
  display: flex;
  justify-content: center;
  position: relative;
  z-index: 1001;
}

.introductionButton {
  border-radius: 8px;
  padding: 10px 20px;
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 500;
  min-width: auto;
  height: auto;
  border: none;
  outline: none;

  &.wizardTheme {
    background: rgba(14, 165, 233, 0.15);
    border: 1px solid rgba(14, 165, 233, 0.3);
    color: rgba(14, 165, 233, 0.9);
    box-shadow: 0 2px 8px rgba(14, 165, 233, 0.2);

    &:hover {
      background: rgba(14, 165, 233, 0.25);
      border-color: rgba(14, 165, 233, 0.5);
      color: rgba(14, 165, 233, 1);
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(14, 165, 233, 0.3);
    }
  }

  &.detectiveTheme {
    background: rgba(209, 183, 115, 0.15);
    border: 1px solid rgba(209, 183, 115, 0.3);
    color: rgba(209, 183, 115, 0.9);
    box-shadow: 0 2px 8px rgba(209, 183, 115, 0.2);

    &:hover {
      background: rgba(209, 183, 115, 0.25);
      border-color: rgba(209, 183, 115, 0.5);
      color: rgba(209, 183, 115, 1);
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(209, 183, 115, 0.3);
    }
  }

  &.spaceTheme {
    background: rgba(166, 170, 251, 0.15);
    border: 1px solid rgba(166, 170, 251, 0.3);
    color: rgba(166, 170, 251, 0.9);
    box-shadow: 0 2px 8px rgba(166, 170, 251, 0.2);

    &:hover {
      background: rgba(166, 170, 251, 0.25);
      border-color: rgba(166, 170, 251, 0.5);
      color: rgba(166, 170, 251, 1);
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(166, 170, 251, 0.3);
    }
  }
}

// Global styles to prevent horizontal scrollbars when Bootstrap popovers appear
// Bootstrap popovers render in a portal (appended to body), so they're not constrained by .myDeckWrapper
:global(html) {
  overflow-x: hidden;
  scrollbar-width: none; /* For Firefox */
}

:global(body) {
  overflow-x: hidden;
  -ms-overflow-style: none; /* IE and Edge */
  
  &::-webkit-scrollbar {
    display: none; /* For Chrome, Safari, and Opera */
  }
}